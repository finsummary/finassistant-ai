# –ö–∞–∫ –Ω–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑—É –∑–Ω–∞–Ω–∏–π (Vector Database)

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ï—Å–ª–∏ –≤—ã –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ `tsx`, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
npm install
```

–≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç `tsx` –∏–∑ `package.json`.

## –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ñ–∞–π–ª–µ `.env.local` –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
OPENAI_API_KEY=your_openai_api_key
```

**–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SUPABASE_SERVICE_ROLE_KEY` (–Ω–µ `SUPABASE_ANON_KEY`), —Ç–∞–∫ –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –æ–±—Ö–æ–¥–∏—Ç—å RLS –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ `financial_knowledge`.

## –®–∞–≥ 3: –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞)

–ü–µ—Ä–µ–¥ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ SQL Editor
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª: `supabase/migrations/20250131000000_create_vector_knowledge.sql`

## –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç A: –ò–∑ –≥–æ—Ç–æ–≤–æ–≥–æ JSON —Ñ–∞–π–ª–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)

```bash
npm run populate-knowledge file
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
npx tsx scripts/populate-knowledge-base.ts file
```

–≠—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç –∑–Ω–∞–Ω–∏—è –∏–∑ `data/initial-financial-knowledge-example.json` (15+ –≥–æ—Ç–æ–≤—ã—Ö –∑–Ω–∞–Ω–∏–π).

### –í–∞—Ä–∏–∞–Ω—Ç B: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ AI (–±–æ–ª—å—à–µ –∑–Ω–∞–Ω–∏–π)

```bash
npm run populate-knowledge generate
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
npx tsx scripts/populate-knowledge-base.ts generate
```

–≠—Ç–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞–Ω–∏—è —á–µ—Ä–µ–∑ OpenAI API –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–µ–º–∞–º.

### –í–∞—Ä–∏–∞–Ω—Ç C: –£–∫–∞–∑–∞—Ç—å —Å–≤–æ–π JSON —Ñ–∞–π–ª

```bash
npx tsx scripts/populate-knowledge-base.ts file data/my-knowledge.json
```

## –ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—É?

**–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ `finassistant-ai`:**

```
C:\Users\user\Desktop\FinAssistant\finassistant-ai>
```

–¢–æ –µ—Å—Ç—å, –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª (PowerShell –∏–ª–∏ Command Prompt) –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —ç—Ç—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:

```powershell
cd C:\Users\user\Desktop\FinAssistant\finassistant-ai
```

–ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É.

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏?

1. –°–∫—Ä–∏–ø—Ç —á–∏—Ç–∞–µ—Ç –∑–Ω–∞–Ω–∏—è –∏–∑ JSON —Ñ–∞–π–ª–∞ (–∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ AI)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç embedding —á–µ—Ä–µ–∑ OpenAI
3. –í—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞–Ω–∏—è —Å embeddings –≤ —Ç–∞–±–ª–∏—Ü—É `financial_knowledge`
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üöÄ Starting knowledge base population...

üìñ Reading knowledge from: data/initial-financial-knowledge-example.json
Found 15 knowledge items

[1/15] Processing: cash_flow - For businesses with runway less than 3 months...
  ‚Üí Generating embedding...
  ‚Üí Inserting into database...
  ‚úÖ Success

[2/15] Processing: expenses - If monthly expenses are growing faster...
  ‚Üí Generating embedding...
  ‚Üí Inserting into database...
  ‚úÖ Success

...

‚úÖ Completed: 15 inserted, 0 errors

‚ú® Done!
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "You exceeded your current quota" (OpenAI)

**–†–µ—à–µ–Ω–∏–µ:** 
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∑–Ω–∞–Ω–∏—è –ë–ï–ó embeddings
- –ü–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –∫–≤–æ—Ç–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è, –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
  ```bash
  npm run update-embeddings
  ```
- –≠—Ç–æ –¥–æ–±–∞–≤–∏—Ç embeddings –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∑–Ω–∞–Ω–∏—è–º

### –û—à–∏–±–∫–∞: "NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY must be set"

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ `.env.local` –∏–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

### –û—à–∏–±–∫–∞: "OPENAI_API_KEY not set"

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ `OPENAI_API_KEY` –≤ `.env.local`.

### –û—à–∏–±–∫–∞: "relation 'financial_knowledge' does not exist"

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –≤ Supabase (—Å–º. –®–∞–≥ 3).

### –û—à–∏–±–∫–∞: "permission denied for table financial_knowledge"

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SUPABASE_SERVICE_ROLE_KEY` –≤–º–µ—Å—Ç–æ `SUPABASE_ANON_KEY`.

### –û—à–∏–±–∫–∞: "tsx is not recognized"

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç–µ `npm install` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ embeddings –ø–æ–∑–∂–µ

–ï—Å–ª–∏ –∑–Ω–∞–Ω–∏—è –±—ã–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –±–µ–∑ embeddings (–∏–∑-–∑–∞ –∫–≤–æ—Ç—ã), –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –ø–æ–∑–∂–µ:

```bash
npm run update-embeddings
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–∞–π–¥–µ—Ç –≤—Å–µ –∑–Ω–∞–Ω–∏—è –±–µ–∑ embeddings –∏ –¥–æ–±–∞–≤–∏—Ç –∏—Ö.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Supabase:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Table Editor
2. –ù–∞–π–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `financial_knowledge`
3. –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏ —Å `content`, `category`, `embedding` (–≤–µ–∫—Ç–æ—Ä)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:

1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ AI-–∞–Ω–∞–ª–∏–∑ –≤ —Ä–∞–∑–¥–µ–ª–µ Framework ‚Üí Choice
2. AI –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞–Ω–∏—è –∏–∑ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –∑–Ω–∞–Ω–∏–π —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç –∏–ª–∏ –≤—Ä—É—á–Ω—É—é
